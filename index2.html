<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IBA BPS 5-15 (Graduation Category) Mock Test For Freebies</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #1e40af;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --light-bg: #f8fafc;
            --dark-bg: #1e293b;
            --text-light: #334155;
            --text-dark: #e2e8f0;
            --border-light: #e2e8f0;
            --border-dark: #475569;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: var(--light-bg);
            color: var(--text-light);
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        body.dark-theme {
            background: var(--dark-bg);
            color: var(--text-dark);
        }

        /* Animated Background Particles */
        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }

        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: var(--primary-color);
            border-radius: 50%;
            opacity: 0.6;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }

        .header p {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Theme Toggle */
        .theme-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
        }

        .control-btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .control-btn:hover {
            transform: scale(1.1);
            background: var(--secondary-color);
        }

        /* Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            background: white;
            border-radius: 15px;
            padding: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin: 2rem 0;
        }

        .dark-theme .welcome-screen {
            background: #334155;
        }

        .welcome-screen h2 {
            color: var(--primary-color);
            margin-bottom: 2rem;
            font-size: 2rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border-light);
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .dark-theme .form-group input {
            background: #475569;
            border-color: var(--border-dark);
            color: var(--text-dark);
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        /* Buttons */
        .btn {
            background: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success-color);
        }

        .btn-danger {
            background: var(--danger-color);
        }

        .btn-warning {
            background: var(--warning-color);
        }

        /* Quiz Interface */
        .quiz-container {
            display: none;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .dark-theme .quiz-container {
            background: #334155;
        }

        .quiz-header {
            background: var(--primary-color);
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .timer {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .progress-info {
            font-size: 0.9rem;
        }

        .quiz-content {
            padding: 2rem;
        }

        .question-container {
            margin-bottom: 2rem;
        }

        .question-text {
            font-size: 1.2rem;
            font-weight: 500;
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }

        .passage {
            background: #f1f5f9;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            border-left: 4px solid var(--primary-color);
        }

        .dark-theme .passage {
            background: #475569;
        }

        .options {
            display: grid;
            gap: 1rem;
        }

        .option {
            background: #f8fafc;
            border: 2px solid var(--border-light);
            border-radius: 8px;
            padding: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dark-theme .option {
            background: #475569;
            border-color: var(--border-dark);
        }

        .option:hover {
            border-color: var(--primary-color);
            background: #e0f2fe;
        }

        .dark-theme .option:hover {
            background: #64748b;
        }

        .option.selected {
            border-color: var(--primary-color);
            background: #dbeafe;
        }

        .dark-theme .option.selected {
            background: #1e40af;
        }

        .option input[type="radio"] {
            margin: 0;
        }

        /* Question Navigation */
        .question-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .nav-buttons {
            display: flex;
            gap: 1rem;
        }

        .bookmark-btn {
            background: var(--warning-color);
        }

        /* Question Palette */
        .question-palette {
            background: #f8fafc;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .dark-theme .question-palette {
            background: #475569;
        }

        .palette-title {
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--primary-color);
        }
        .palette-grid {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            white-space: nowrap;
            padding-bottom: 8px;
        }
        .palette-item {
            width: 60px;
            height: 40px;
            border: 2px solid var(--border-light);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            background: white;
        }

        .palette-grid::-webkit-scrollbar {
            height: 6px;
        }

        .palette-grid::-webkit-scrollbar-thumb {
            background-color: #ccc;
            border-radius: 3px;
        }

        .dark-theme .palette-item {
            background: #64748b;
            border-color: var(--border-dark);
        }

        .palette-item.answered {
            background: var(--success-color);
            color: white;
            border-color: var(--success-color);
        }

        .palette-item.bookmarked {
            background: var(--warning-color);
            color: white;
            border-color: var(--warning-color);
        }

        .palette-item.current {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            text-align: center;
        }

        .dark-theme .modal-content {
            background: #334155;
        }

        .modal h2 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }

        .modal p {
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        /* Results */
        .results-container {
            display: none;
            text-align: center;
            background: white;
            border-radius: 15px;
            padding: 3rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .dark-theme .results-container {
            background: #334155;
        }

        .score-display {
            font-size: 3rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 1rem 0;
        }

        .result-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .stat-card {
            background: #f8fafc;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid var(--primary-color);
        }

        .dark-theme .stat-card {
            background: #475569;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-top: 0.5rem;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header h1 {
                font-size: 1.4rem;
            }

            .quiz-header {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }

            .question-nav {
                flex-direction: column;
            }

            .nav-buttons {
                justify-content: center;
            }

            .theme-controls {
                top: 10px;
                right: 10px;
            }

            .result-stats {
                grid-template-columns: 1fr;
            }
        }

        /* Fullscreen Mode */
        .fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            z-index: 999;
            background: var(--light-bg);
        }

        .dark-theme .fullscreen {
            background: var(--dark-bg);
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Urdu Text Support */
        .urdu-text {
            font-family: 'Lato', sans-serif;
            direction: rtl;
            text-align: right;
        }

        .urdu-text h2 {
            text-align: center;
        }

        /* Footer */
        .footer {
            background: var(--primary-color);
            color: white;
            text-align: center;
            padding: 1rem;
            margin-top: 2rem;
            font-size: 0.9rem;
        }

        .footer a {
            color: #fbbf24;
            text-decoration: none;
            font-weight: 500;
        }

        .footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <div class="theme-controls">
        <button class="control-btn" id="theme-toggle" title="Toggle Theme">
            <i class="fas fa-moon"></i>
        </button>
        <button class="control-btn" id="fullscreen-toggle" title="Toggle Fullscreen">
            <i class="fas fa-expand"></i>
        </button>
    </div>

    <div class="header">
        <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 10px;">
            <h1 style="margin: 0;"><i class="fas fa-graduation-cap"></i> Mock Test Hub</h1>
        </div>
        <h2 style="margin: 10px 0; font-size: 1.4rem;">IBA BPS 5-15 (Graduation Category) Mock Test For Freebies</h2>
        <p>Test your knowledge and prepare for the IBA BPS 5-15 exam!</p>
    </div>

    <div class="container">
        <div class="welcome-screen" id="welcome-screen">
            <h2><i class="fas fa-user-graduate"></i> Welcome to Mock Test</h2>
            <p>Please enter your details to begin the test. Remember, you can only take this test once!</p>
            
            <form id="user-form">
                <div class="form-group">
                    <label for="user-name"><i class="fas fa-user"></i> Full Name</label>
                    <input type="text" id="user-name" required placeholder="Enter your full name">
                </div>
                <div class="form-group">
                    <label for="user-email"><i class="fas fa-envelope"></i> Email Address</label>
                    <input type="email" id="user-email" required placeholder="Enter your email address">
                </div>
                <button type="submit" class="btn">
                    <i class="fas fa-play"></i> Start Test
                </button>
            </form>
        </div>

        <div class="quiz-container" id="quiz-container">
            <div class="quiz-header">
                <div class="timer">
                    <i class="fas fa-clock"></i> Time: <span id="timer">60:00</span>
                </div>
                <div class="progress-info">
                    Question <span id="current-question">1</span> of <span id="total-questions">20</span>
                </div>
                <div class="progress-info">
                    Answered: <span id="answered-count">0</span> | Bookmarked: <span id="bookmarked-count">0</span>
                </div>
            </div>

            <div class="quiz-content">
                
                <div class="question-container" id="question-container">
                    </div>

                <div class="question-nav">
                    <div class="nav-buttons">
                        <button class="btn" id="prev-btn" disabled>
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        <button class="btn bookmark-btn" id="bookmark-btn">
                            <i class="fas fa-bookmark"></i> Bookmark
                        </button>
                    </div>
                    <div class="nav-buttons">
                        <button class="btn" id="next-btn">
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                        <button class="btn btn-danger" id="submit-btn" style="display: none;">
                            <i class="fas fa-paper-plane"></i> Submit Test
                        </button>
                    </div>
                    
                </div>
                
            </div>
            <div class="question-palette">
                    <div class="palette-title"><i class="fas fa-th"></i> Question Navigator</div>
                    <div class="palette-grid" id="question-palette"></div>
                </div>

        </div>

        <div class="results-container" id="results-container">
            <h2><i class="fas fa-trophy"></i> Test Results</h2>
            <div class="score-display" id="score-display">0%</div>
            <div id="pass-status"></div>
            
            <div class="result-stats">
                <div class="stat-card">
                    <div class="stat-value" id="correct-answers">0</div>
                    <div class="stat-label">Correct Answers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="wrong-answers">0</div>
                    <div class="stat-label">Wrong Answers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="time-taken">0:00</div>
                    <div class="stat-label">Time Taken</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="total-score">0/20</div>
                    <div class="stat-label">Total Score</div>
                </div>
            </div>

            <button class="btn btn-success" id="download-certificate">
                <i class="fas fa-download"></i> Download Certificate
            </button>
        </div>
    </div>

    <div class="modal" id="notice-modal">
        <div class="modal-content">
            <h2><i class="fas fa-info-circle"></i> Aham Elaan</h2>
            <p>Test dene se pehle aap ko batate chalen ke yeh ek muft mock test hai. Aap sirf ek hi baar test de sakte hain. Ek baar test jama hone ke baad, aap apne system se dobara test nahi de sakte.</p>
            <p>Aapke taawun ka be-had shukriya.</p>
            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn btn-primary" id="close-notice-modal-btn">
                    <i class="fas fa-check-circle"></i> Samajh Gaya
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="review-modal">
        <div class="modal-content">
            <h2><i class="fas fa-eye"></i> Review Your Answers</h2>
            <p>Are you sure you want to submit the test? You cannot change your answers after submission.</p>
            <div id="review-summary"></div>
            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem;">
                <button class="btn" id="continue-test-btn">
                    <i class="fas fa-arrow-left"></i> Continue Test
                </button>
                <button class="btn btn-danger" id="final-submit-btn">
                    <i class="fas fa-paper-plane"></i> Submit Final
                </button>
            </div>
        </div>
    </div>

    <div class="modal" id="alert-modal">
        <div class="modal-content">
            <h2 id="alert-title"><i class="fas fa-exclamation-triangle"></i> Alert</h2>
            <p id="alert-message"></p>
            <button class="btn" id="alert-ok-btn">
                <i class="fas fa-check"></i> OK
            </button>
        </div>
    </div>

    <div class="footer">
        <p>&copy; 2015 IBA BPS 5-15 (Graduation Category). Powered By <a href="https://mock-test-hub.netlify.app">Mock Test Hub</a></p>
    </div>

    <script>
        // Firebase Configuration (Replace with your config)
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyDL31F-90bUtUDaWBV6TmNppVYiR4Nno04",
            authDomain: "mocktest2-4e09a.firebaseapp.com",
            projectId: "mocktest2-4e09a",
            storageBucket: "mocktest2-4e09a.firebasestorage.app",
            messagingSenderId: "621047277450",
            appId: "1:621047277450:web:3d92729d055add65f04a73",
            measurementId: "G-X87344PJXQ"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // --- DOM Elements ---
        const welcomeScreen = document.getElementById('welcome-screen');
        const quizContainer = document.getElementById('quiz-container');
        const resultsContainer = document.getElementById('results-container');
        const userForm = document.getElementById('user-form');
        const userNameInput = document.getElementById('user-name');
        const userEmailInput = document.getElementById('user-email');
        const questionContainer = document.getElementById('question-container');
        const timerDisplay = document.getElementById('timer');
        const currentQuestionSpan = document.getElementById('current-question');
        const totalQuestionsSpan = document.getElementById('total-questions');
        const answeredCountSpan = document.getElementById('answered-count');
        const bookmarkedCountSpan = document.getElementById('bookmarked-count');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const bookmarkBtn = document.getElementById('bookmark-btn');
        const submitBtn = document.getElementById('submit-btn');
        const questionPalette = document.getElementById('question-palette');
        const scoreDisplay = document.getElementById('score-display');
        const passStatus = document.getElementById('pass-status');
        const correctAnswersSpan = document.getElementById('correct-answers');
        const wrongAnswersSpan = document.getElementById('wrong-answers');
        const timeTakenSpan = document.getElementById('time-taken');
        const totalScoreSpan = document.getElementById('total-score');
        const downloadCertificateBtn = document.getElementById('download-certificate');
        const noticeModal = document.getElementById('notice-modal');
        const closeNoticeModalBtn = document.getElementById('close-notice-modal-btn');
        const reviewModal = document.getElementById('review-modal');
        const reviewSummary = document.getElementById('review-summary');
        const continueTestBtn = document.getElementById('continue-test-btn');
        const finalSubmitBtn = document.getElementById('final-submit-btn');
        const alertModal = document.getElementById('alert-modal');
        const alertTitle = document.getElementById('alert-title');
        const alertMessage = document.getElementById('alert-message');
        const alertOkBtn = document.getElementById('alert-ok-btn');
        const themeToggleBtn = document.getElementById('theme-toggle');
        const fullscreenToggleBtn = document.getElementById('fullscreen-toggle');
        const particlesContainer = document.getElementById('particles');

        // Sample Questions Data (This data is already in your file, ensure it's complete)
              const questionsData = [
  {
    id: 1,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "What is the main theme of the passage?",
    options: ["Importance of technology", "Need for quick success", "Power of patience", "Benefits of farming"],
    correct: 2
  },
  {
    id: 2,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "The phrase 'Rome wasn't built in a day' means:",
    options: ["Cities take time to develop", "Success needs patience and time", "Rome is a historic city", "Building is a long process"],
    correct: 1
  },
  {
    id: 3,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "What does the word 'persevere' mean in the passage?",
    options: ["To plan quickly", "To remain calm", "To give up easily", "To keep trying despite difficulties"],
    correct: 3
  },
  {
    id: 4,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "Which idiom from the passage means staying calm in difficulty?",
    options: ["Built in a day", "On course", "Calm during a storm", "Water the seed"],
    correct: 2
  },
  {
    id: 5,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "Choose the synonym of 'overlooked' as used in the passage:",
    options: ["Not seen", "Ignored", "Watched", "Delayed"],
    correct: 1
  },
  {
    id: 6,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "What can be inferred about modern people, according to the passage?",
    options: ["They are more patient than before", "They avoid using technology", "They desire quick results", "They love farming"],
    correct: 2
  },
  {
    id: 7,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "The farmer is used as a symbol of:",
    options: ["Technology", "Patience and effort", "Modern tools", "Failure"],
    correct: 1
  },
  {
    id: 8,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "The phrase 'stay on course' means:",
    options: ["Follow directions", "Travel by ship", "Maintain focus", "Change goals"],
    correct: 2
  },
  {
    id: 9,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "Which of the following best supports the author's point?",
    options: ["Using faster technology reduces effort", "Achievements are random and luck-based", "Consistent hard work leads to success", "Decisions should be made quickly"],
    correct: 2
  },
  {
    id: 10,
    type: "reading",
    passage: " In today's fast-paced world, the value of patience is often overlooked. People seek instant results, whether it's in their careers, relationships, or daily routines. However, true success often requires consistent effort over time. A farmer, for instance, does not plant a seed and expect fruit the next day. He nurtures the soil, waters the seed, and waits patiently. Similarly, in life, goals are achieved by those who persevere. Patience fosters better decision-making and reduces impulsive actions. It is the calm during a storm that helps one stay on course. While technology has made many things quicker, it cannot replace the benefits of enduring effort. Therefore, cultivating patience is not a weakness, but a strength that leads to long-term growth. As the saying goes, 'Rome wasn't built in a day.'",
    question: "Why does the author mention technology?",
    options: ["To show it's harmful", "To prove it's better than patience", "To contrast it with human qualities", "To recommend faster decisions"],
    correct: 2
  },
  {
    id: 11,
    type: "mcq",
    question: "I don't like alien fashions.",
    options: ["foreign", "extraneous", "unusual", "exotic"],
    correct: 0
  },
  {
    id: 12,
    type: "mcq",
    question: "The inspector was a vigilant young man.",
    options: ["intelligent", "ambitious", "watchful", "smart"],
    correct: 2
  },
  {
    id: 13,
    type: "mcq",
    question: "Many species of animals have become extinct during the last hundred years.",
    options: ["aggressive", "non-existent", "scattered", "feeble"],
    correct: 1
  },
  {
    id: 14,
    type: "mcq",
    question: "The tablet alleviated the pain, and the patient was soon feeling much better.",
    options: ["mitigated", "moderated", "removed", "lightened"],
    correct: 0
  },
  {
    id: 15,
    type: "mcq",
    question: "They were totally unaware of the impending disaster.",
    options: ["threatening", "imminent", "terrible", "possible"],
    correct: 1
  },
  {
    id: 16,
    type: "mcq",
    question: "He spoke against corruption with zeal.",
    options: ["indifference", "calmness", "despair", "passiveness"],
    correct: 0
  },
  {
    id: 17,
    type: "mcq",
    question: "Adversity teaches man to be humble and self-reliant.",
    options: ["sincerity", "animosity", "curiosity", "prosperity"],
    correct: 3
  },
  {
    id: 18,
    type: "mcq",
    question: "The chairman initiated the proceedings with a brief speech.",
    options: ["confused", "closed", "started", "complicated"],
    correct: 1
  },
  {
    id: 19,
    type: "mcq",
    question: "The leader was pragmatic in his approach to the problem facing the country.",
    options: ["indefinite", "vague", "idealistic", "optimistic"],
    correct: 2
  },
  {
    id: 20,
    type: "mcq",
    question: "We had a delectable meal yesterday.",
    options: ["heavy", "unsavory", "tasty", "nice"],
    correct: 1
  },
  {
    id: 21,
    type: "mcq",
    question: "Identify the error: The capital of Yemen / is situating / 2190 meters above / the sea level.",
    options: ["The capital of Yemen", "is situating", "2190 meters above", "the sea level"],
    correct: 1
  },
  {
    id: 22,
    type: "mcq",
    question: "Identify the error: Either Nemmu or Mennu / are in the wrong; / both can / certainly never be.",
    options: ["Either Nemmu or Mennu", "are in the wrong", "both can", "certainly never be"],
    correct: 1
  },
  {
    id: 23,
    type: "mcq",
    question: "Identify the error: Everyone knows / that the leopard is / faster / of all animals.",
    options: ["Everyone knows", "that the leopards is", "faster", "of all animals."],
    correct: 3
  },
  {
    id: 24,
    type: "mcq",
    question: "Identify the error: Ramu is the elected leader / and also a person / who we all / can confide in.",
    options: ["Ramu is the elected leader", "and also a person", "who we all", "can confide in"],
    correct: 2
  },
  {
    id: 25,
    type: "mcq",
    question: "Identify the error: As our room was / upstairs, so we / didn't hear him.",
    options: ["As our room was", "upstairs, so we", "didn't hear him", "No error"],
    correct: 3
  },
  {
    id: 26,
    type: "mcq",
    question: "We arrived ______ the station an hour late?",
    options: ["of", "in", "about", "at"],
    correct: 3
  },
  {
    id: 27,
    type: "mcq",
    question: "I am good ______ tennis?",
    options: ["of", "in", "about", "at"],
    correct: 3
  },
  {
    id: 28,
    type: "mcq",
    question: "They decided ______ the grey sofa?",
    options: ["of", "in", "about", "on"],
    correct: 3
  },
  {
    id: 29,
    type: "mcq",
    question: "He confided ______ me?",
    options: ["of", "in", "about", "on"],
    correct: 1
  },
  {
    id: 30,
    type: "mcq",
    question: "I am envious ______ them?",
    options: ["of", "in", "about", "on"],
    correct: 0
  },
  {
    id: 31,
    type: "mcq",
    question: "The small child does whatever his father ______.",
    options: ["has done", "did", "does", "had done"],
    correct: 2
  },
  {
    id: 32,
    type: "mcq",
    question: "The man to ______ my house was a cheat.",
    options: ["to whom I sell", "to who I sell", "who was sold to", "to whom I sold"],
    correct: 3
  },
  {
    id: 33,
    type: "mcq",
    question: "He is too important ______ any delay.",
    options: ["to tolerate", "to tolerating", "at tolerating", "with tolerating"],
    correct: 0
  },
  {
    id: 34,
    type: "mcq",
    question: "The performance of our players was rather ______.",
    options: ["bad as I had expected", "worse than I had expected", "worse than expectation", "worst than was expected"],
    correct: 1
  },
  {
    id: 35,
    type: "mcq",
    question: "Why ______ the bag away?",
    options: ["did you not threw", "had you not threw", "did you not thrown", "you did not thrown"],
    correct: 0
  },
  {
    id: 36,
    type: "mcq",
    question: "Choose the correct spelling.",
    options: ["promiscuous", "promiscuos", "promisuous", "promisscuous"],
    correct: 0
  },
  {
    id: 37,
    type: "mcq",
    question: "Choose the correct spelling.",
    options: ["Condescend", "Condascend", "Condescand", "Condiscend"],
    correct: 0
  },
  {
    id: 38,
    type: "mcq",
    question: "Choose the correct spelling.",
    options: ["Temparary", "Temperary", "Temporary", "Temprary"],
    correct: 2
  },
  {
    id: 39,
    type: "mcq",
    question: "Choose the correct spelling.",
    options: ["Pronounciation", "Pronounciation", "Pronnounciation", "Pronunciation"],
    correct: 3
  },
  {
    id: 40,
    type: "mcq",
    question: "Choose the correct spelling.",
    options: ["Entrepreneurship", "Enterpreneurship", "Enterpreneaurship", "Interpreneurship"],
    correct: 0
  },
  {
    id: 41,
    type: "mcq",
    question: "Find the roots of quadratic equation: $x^2 + x - 42 = 0$",
    options: ["-6, 7", "-8, 7", "14, -3", "-7, 6"],
    correct: 3
  },
  {
    id: 42,
    type: "mcq",
    question: "The sum of the square of the three consecutive even natural numbers is 1460. Find the numbers?",
    options: ["18, 20, 22", "20, 22, 24", "22, 24, 26", "24, 26, 28"],
    correct: 1
  },
  {
    id: 43,
    type: "mcq",
    question: "The least among the following is:",
    options: ["0.2", "1 - 0.2", "$0.2^2$", "$(0.2)^2$"],
    correct: 2
  },
  {
    id: 44,
    type: "mcq",
    question: "If $a-b=3$ and $a^2+b^2=29$, find the value of ab.",
    options: ["10", "12", "15", "18"],
    correct: 0
  },
  {
    id: 45,
    type: "mcq",
    question: "What should come in place of both x in the equation $x/\\sqrt{128} = \\sqrt{162}/x$?",
    options: ["12", "14", "144", "196"],
    correct: 0
  },
  {
    id: 46,
    type: "mcq",
    question: "$\\sqrt{1.5625}=?$",
    options: ["1.05", "1.25", "1.45", "1.55"],
    correct: 1
  },
  {
    id: 47,
    type: "mcq",
    question: "If 10 men or 20 boys can make 260 mats in 20 days, then how many mats will be made by 8 men and 4 boys in 20 days?",
    options: ["260", "240", "280", "520"],
    correct: 0
  },
  {
    id: 48,
    type: "mcq",
    question: "A man is 24 years older than his son. In two years, his age will be twice the age of his son. The present age of his son is:",
    options: ["14 years", "18 years", "20 years", "22 years"],
    correct: 3
  },
  {
    id: 49,
    type: "mcq",
    question: "A two-digit number is such that the product of the digits is 8. When 18 is added to the number, then the digits are reversed. The number is:",
    options: ["18", "24", "42", "81"],
    correct: 1
  },
  {
    id: 50,
    type: "mcq",
    question: "66 cubic centimetres of silver is drawn into a wire 1 mm in diameter. The length of the wire in metres will be:",
    options: ["84 metres", "90 meters", "168 meters", "336 meters"],
    correct: 0
  },
  {
    id: 51,
    type: "mcq",
    question: "In one hour, a boat goes 11 km/hr along the stream and 5 km/hr against the stream. The speed of the boat in still water (in km/hr) is:",
    options: ["3 kmph", "5 kmph", "8 kmph", "9 kmph"],
    correct: 2
  },
  {
    id: 52,
    type: "mcq",
    question: "Sum of three consecutive even integers is 54. Find the least integer among them.",
    options: ["18", "15", "14", "16"],
    correct: 3
  },
  {
    id: 53,
    type: "mcq",
    question: "A clock was sold for Rs. 144. If the percentage of profit was numerically equal to the cost price, the cost of the clock was -",
    options: ["Rs. 72", "Rs. 80", "Rs. 90", "Rs. 100"],
    correct: 1
  },
  {
    id: 54,
    type: "mcq",
    question: "A train, 150 m long, passes a pole in 15 seconds and another train of the same length travelling in the opposite direction in 12 seconds. The speed of the second train is :",
    options: ["45 km/hr", "48 km/hr", "52 km/hr", "54 km/hr"],
    correct: 3
  },
  {
    id: 55,
    type: "mcq",
    question: "If the arithmetic mean of seventy-five numbers is 35. If each number is increased by 5, then mean of new numbers is:",
    options: ["30", "40", "70", "90"],
    correct: 1
  },
  {
    id: 56,
    type: "mcq",
    question: "Find the 15th term of the sequence 20, 15, 10 .....",
    options: ["-45", "-55", "-50", "0"],
    correct: 2
  },
  {
    id: 57,
    type: "mcq",
    question: "In how many ways can 8 Indians, 4 Americans and 4 Englishmen be seated in a row so that all persons of the same nationality sit together?",
    options: ["3! 8! 4! 4!", "3! 8!", "4! 4!", "8! 4! 4!"],
    correct: 0
  },
  {
    id: 58,
    type: "mcq",
    question: "Three partners A, B, C start a business. B's Capital is four times C's capital and twice A's capital is equal to thrice B's capital. If the total profit is Rs 16500, Find out B's share in it.",
    options: ["Rs. 4000", "Rs. 5000", "Rs. 6000", "Rs. 7000"],
    correct: 2
  },
  {
    id: 59,
    type: "mcq",
    question: "The LCM of three different numbers is 120. Which of the following cannot be their HCF?",
    options: ["8", "12", "24", "35"],
    correct: 3
  },
  {
    id: 60,
    type: "mcq",
    question: "If the height of a pole is $2\\sqrt{3}$ metres and the length of its shadow is 2 metres, find the angle of elevation of the sun.",
    options: ["50°", "60°", "70°", "80°"],
    correct: 1
  },
  {
    id: 61,
    type: "mcq",
    question: "The smallest country in South America is?",
    options: ["Uruguay", "Guyana", "Surinam", "Ecuador"],
    correct: 2
  },
  {
    id: 62,
    type: "mcq",
    question: "The Barents Sea is located along the coasts of which two countries?",
    options: ["Russia-Ukraine", "Russia-Norway", "Russia-Belarus", "None of All"],
    correct: 1
  },
  {
    id: 63,
    type: "mcq",
    question: "Parliament of Norway is known as:",
    options: ["Althing", "Storting", "Federal Assembly", "Congress"],
    correct: 1
  },
  {
    id: 64,
    type: "mcq",
    question: "What is the sweetest language in the world?",
    options: ["English", "Spanish", "Bengali", "Urdu"],
    correct: 2
  },
  {
    id: 65,
    type: "mcq",
    question: "Loro Sae is the new name of?",
    options: ["Gold Coast", "East Timor", "Guyana", "Saigon"],
    correct: 1
  },
  {
    id: 66,
    type: "mcq",
    question: "Chad is the landlocked country of ______.",
    options: ["Europe", "Asia", "Africa", "South America"],
    correct: 2
  },
  {
    id: 67,
    type: "mcq",
    question: "Kuril Island disputed between?",
    options: ["Sri Lanka and India", "Nepal and India", "Japan and Russia", "USA and Canada"],
    correct: 2
  },
  {
    id: 68,
    type: "mcq",
    question: "What is the mother name of Allama Iqbal?",
    options: ["Imam Bibi", "Kareem Bibi", "Zainab Bibi", "None of All"],
    correct: 0
  },
  {
    id: 69,
    type: "mcq",
    question: "Second Highest Mountain of the world K-2 is located in ______?",
    options: ["Gilgit Baltistan", "KPK", "FATA", "Kashmir"],
    correct: 0
  },
  {
    id: 70,
    type: "mcq",
    question: "The length of Ravi River is ______?",
    options: ["730km", "725km", "760km", "720km"],
    correct: 3
  },
  {
    id: 71,
    type: "mcq",
    question: "M6 is the motorway between ______?",
    options: ["Hyderabad and Karachi", "Sukkur and Multan", "Lahore and Islamabad", "Hyderabad and Sukkur"],
    correct: 3
  },
  {
    id: 72,
    type: "mcq",
    question: "When was Liaquat Nehru Pact between India and Pakistan signed?",
    options: ["1950", "1955", "1964", "1951"],
    correct: 0
  },
  {
    id: 73,
    type: "mcq",
    question: "The Picture on the back of 50 Rupee Pakistani Note?",
    options: ["Faisal Mosque", "K2", "Ziarat Residency", "Islamia College, Peshawar"],
    correct: 1
  },
  {
    id: 74,
    type: "mcq",
    question: "The crescent in the Pakistani Flag represents ______.",
    options: ["happiness", "development", "progress", "None of All"],
    correct: 2
  },
  {
    id: 75,
    type: "mcq",
    question: "Which Gulf country has signed an agreement with US to build the largest artificial intelligence campus outside the United States?",
    options: ["Saudia Arabia", "UAE", "Qatar", "None of All"],
    correct: 1
  },
  {
    id: 76,
    type: "mcq",
    question: "Virus was discovered by?",
    options: ["Dmitry Ivanovsky", "Robert hook", "Antony", "Brown"],
    correct: 0
  },
  {
    id: 77,
    type: "mcq",
    question: "When WBCs greatly increased in number, they cause a disease called?",
    options: ["Anaemia", "Leukaemia", "Haemophilia", "Diarrhoea"],
    correct: 1
  },
  {
    id: 78,
    type: "mcq",
    question: "Which element is called earth maker?",
    options: ["Oxygen", "Silicon", "Carbon", "Hydrogen"],
    correct: 1
  },
  {
    id: 79,
    type: "mcq",
    question: "Which of the followings planet can float on water?",
    options: ["Saturn", "Mars", "Venus", "None"],
    correct: 0
  },
  {
    id: 80,
    type: "mcq",
    question: "What is the one of the other name of Vitamin A?",
    options: ["Riboflavin", "Ascorbic Acid", "Retinol", "Thiamin"],
    correct: 2
  },
  {
    id: 81,
    type: "mcq",
    question: "What type of a mirror is used in anti-shop-lifting-devices?",
    options: ["Convex mirror", "Concave mirror", "Plane mirror", "Both (b) and (c)"],
    correct: 0
  },
  {
    id: 82,
    type: "mcq",
    question: "Biosensor is used to measure?",
    options: ["Blood glucose level", "The body pH value", "Amount of hemoglobin", "Salinity in Urine"],
    correct: 0
  },
  {
    id: 83,
    type: "mcq",
    question: "Lygophobia fear for?",
    options: ["Sunlight", "Moonlight", "Flash", "Darkness"],
    correct: 3
  },
  {
    id: 84,
    type: "mcq",
    question: "The average heartbeat per minute in a normal man is ____?",
    options: ["50", "70", "80", "100"],
    correct: 1
  },
  {
    id: 85,
    type: "mcq",
    question: "Which of the following have maximum calorific value?",
    options: ["Carbohydrates", "Fats", "Proteins", "Vitamins"],
    correct: 1
  },
  {
    id: 86,
    type: "mcq",
    question: "Quaid-e-Azam started practice in which city of subcontinent?",
    options: ["Delhi", "Calcutta", "Bombay", "Dhaka"],
    correct: 2
  },
  {
    id: 87,
    type: "mcq",
    question: "The real name of Muhammad Shah Rangeela (The last Mughal king to sit on Peacock Throne)?",
    options: ["Gulshan Khan", "Roshan Akhtar", "Jamshed Akhtar", "Khurram Shehzad"],
    correct: 1
  },
  {
    id: 88,
    type: "mcq",
    question: "Name the First Pakistani who won Pulitzer Prize?",
    options: ["Dr Abul Qadeer Khan", "Dr Raza Bakir", "Malala Yousuf Zai", "Adrees Latif"],
    correct: 3
  },
  {
    id: 89,
    type: "mcq",
    question: "When did the battle of camel take place?",
    options: ["30 A.H.", "34 A.H.", "36 A.H.", "38 A.H."],
    correct: 2
  },
  {
    id: 90,
    type: "mcq",
    question: "The Holy Prophet offered first Jumma prayer in______.",
    options: ["10 Nabvi", "1 A.H", "2 A.H", "None of all"],
    correct: 1
  },
  {
    id: 91,
    type: "mcq",
    question: "The ribbon in Word 2007 consists of a series of ______?",
    options: ["Gates", "Smaller ribbons", "Tabs", "Icons"],
    correct: 2
  },
  {
    id: 92,
    type: "mcq",
    question: "What is the shortcut key for 'Clear All Formatting' the selected text?",
    options: ["Ctrl + Del", "Ctrl + Enter", "Ctrl + Spacebar", "Shift + F3"],
    correct: 2
  },
  {
    id: 93,
    type: "mcq",
    question: "By default, your document prints with ______.",
    options: ["1 inch top and bottom margins", "a portrait orientation", "1.25 inches left and right margins", "all of the above"],
    correct: 3
  },
  {
    id: 94,
    type: "mcq",
    question: "How many rows can you insert in a word document in maximum?",
    options: ["256", "16384", "32767", "Unlimited"],
    correct: 2
  },
  {
    id: 95,
    type: "mcq",
    question: "Another name for a pre-programmed formula in excel is ______.",
    options: ["Cell", "Graph", "Function", "Range"],
    correct: 2
  },
  {
    id: 96,
    type: "mcq",
    question: "How do you display current date and time in MS Excel?",
    options: ["Date()", "Year()", "Now()", "Time()"],
    correct: 2
  },
  {
    id: 97,
    type: "mcq",
    question: "What displays the content of active cell?",
    options: ["Name box", "Row headings", "Formula bar", "None of All"],
    correct: 2
  },
  {
    id: 98,
    type: "mcq",
    question: "Special effects used to introduce slides in a presentation are called ______.",
    options: ["Effects", "Custom animations", "Transitions", "Preset animations"],
    correct: 2
  },
  {
    id: 99,
    type: "mcq",
    question: "How can you create a uniform appearance by adding a background image to all slides?",
    options: ["Create a template", "Edit the slide master", "Use the autocorrect wizard", "All of the above"],
    correct: 1
  },
  {
    id: 100,
    type: "mcq",
    question: "What is the term used when you press and hold the left mouse key and move the mouse around the slide?",
    options: ["Highlighting", "Dragging", "Selecting", "Moving"],
    correct: 1
  }
];
        let currentQuestionIndex = 0;
        let userAnswers = []; // Stores selected option index for each question
        let bookmarkedQuestions = [];
        let timerInterval;
        let timeLeft = 60 * 60; // 60 minutes in seconds
        let userName = '';
        let userEmail = '';
        let quizStartTime;
        let finalScore = 0; // Initialize finalScore here
        let userScorePercentage = 0; // Initialize userScorePercentage here
        let userStatus = "Fail"; // Initialize userStatus here


        // Add this constant for passing score
        const totalQuestionsCount = questionsData.length; // Ensure this reflects the actual number of questions
        const passingScorePercentage = 40; // Set your desired passing score percentage (e.g., 60% to pass)


        // Particle animation
        function createParticle() {
            const particle = document.createElement('div');
            particle.classList.add('particle');
            particlesContainer.appendChild(particle);

            const size = Math.random() * 5 + 2; // size from 2px to 7px
            particle.style.width = `${size}px`;
            particle.style.height = `${size}px`;

            const x = Math.random() * window.innerWidth;
            const y = Math.random() * window.innerHeight;
            particle.style.left = `${x}px`;
            particle.style.top = `${y}px`;

            const duration = Math.random() * 6 + 3; // duration from 3s to 9s
            particle.style.animationDuration = `${duration}s`;
            particle.style.animationDelay = `-${Math.random() * duration}s`; // Start at random points in animation

            particle.addEventListener('animationend', () => {
                particle.remove();
            });
        }

        // Generate particles periodically
        setInterval(createParticle, 300); // Create a new particle every 300ms


        // Theme Toggle
        themeToggleBtn.addEventListener('click', () => {
            document.body.classList.toggle('dark-theme');
            const isDark = document.body.classList.contains('dark-theme');
            themeToggleBtn.innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            localStorage.setItem('theme', isDark ? 'dark' : 'light');
        });

        // Apply saved theme
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'dark') {
            document.body.classList.add('dark-theme');
            themeToggleBtn.innerHTML = '<i class="fas fa-sun"></i>';
        }

        // Fullscreen Toggle
        fullscreenToggleBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(e => {
                    console.error(`Error attempting to enable full-screen mode: ${e.message} (${e.name})`);
                    showAlert('Fullscreen Not Supported', 'Your browser does not support fullscreen mode or it was denied.');
                });
            } else {
                document.exitFullscreen();
            }
        });


        // Handle user form submission
        userForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            userName = userNameInput.value.trim();
            userEmail = userEmailInput.value.trim().toLowerCase();

            if (!userName || !userEmail) {
                showAlert('Error', 'Please enter your full name and email address.');
                return;
            }

            try {
                // Check if user has already taken the test using their email
                const userDoc = await db.collection('users').where('email', '==', userEmail).get();
                if (!userDoc.empty) {
                    showAlert('Test Already Taken', 'You have already taken this test. You can only take it once.');
                    return;
                }

                // If user hasn't taken the test, proceed
                welcomeScreen.style.display = 'none';
                quizContainer.style.display = 'block';
                initializeQuiz();
            } catch (error) {
                console.error("Error checking user:", error);
                showAlert('Error', 'Failed to start test. Please try again.');
            }
        });

        function initializeQuiz() {
            // Shuffle questions to make each attempt unique (optional)
            // questionsData.sort(() => Math.random() - 0.5); 
            
            userAnswers = Array(questionsData.length).fill(null);
            bookmarkedQuestions = Array(questionsData.length).fill(false);
            totalQuestionsSpan.textContent = questionsData.length;
            quizStartTime = new Date(); // Record quiz start time
            startTimer();
            loadQuestion(currentQuestionIndex);
            createQuestionPalette();
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 60);
                const seconds = timeLeft % 60;
                timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    submitTest(true); // Auto-submit when time runs out
                }
            }, 1000);
        }

        function loadQuestion(index) {
            currentQuestionIndex = index;
            const question = questionsData[currentQuestionIndex];
            questionContainer.innerHTML = ''; // Clear previous question

            const qNum = document.createElement('p');
            qNum.className = 'question-text';
            qNum.innerHTML = `Q${currentQuestionIndex + 1}. ${question.question}`;
            questionContainer.appendChild(qNum);

            if (question.passage) {
                const passageDiv = document.createElement('div');
                passageDiv.className = 'passage';
                passageDiv.innerHTML = `<p>${question.passage}</p>`;
                questionContainer.insertBefore(passageDiv, qNum.nextSibling);
            }

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options';
            question.options.forEach((option, i) => {
                const optionDiv = document.createElement('label');
                optionDiv.className = 'option';
                optionDiv.innerHTML = `
                    <input type="radio" name="question-${question.id}" value="${i}" ${userAnswers[currentQuestionIndex] === i ? 'checked' : ''}>
                    <span>${option}</span>
                `;
                optionDiv.addEventListener('click', () => {
                    selectOption(i);
                });
                optionsDiv.appendChild(optionDiv);
            });
            questionContainer.appendChild(optionsDiv);

            updateNavigationButtons();
            updatePalette();
            updateCounts();
        }

        function selectOption(selectedIndex) {
            userAnswers[currentQuestionIndex] = selectedIndex;
            // Update UI for selected option
            const options = questionContainer.querySelectorAll('.option');
            options.forEach((option, i) => {
                if (i === selectedIndex) {
                    option.classList.add('selected');
                    option.querySelector('input[type="radio"]').checked = true;
                } else {
                    option.classList.remove('selected');
                    option.querySelector('input[type="radio"]').checked = false;
                }
            });
            updatePalette();
            updateCounts();
        }

        function updateNavigationButtons() {
            prevBtn.disabled = currentQuestionIndex === 0;
            nextBtn.style.display = currentQuestionIndex === questionsData.length - 1 ? 'none' : 'inline-flex';
            submitBtn.style.display = currentQuestionIndex === questionsData.length - 1 ? 'inline-flex' : 'none';

            // Update bookmark button icon
            bookmarkBtn.innerHTML = bookmarkedQuestions[currentQuestionIndex] ? 
                                    '<i class="fas fa-bookmark"></i> Bookmarked' : 
                                    '<i class="far fa-bookmark"></i> Bookmark';
        }

        function createQuestionPalette() {
            questionPalette.innerHTML = '';
            questionsData.forEach((_, i) => {
                const paletteItem = document.createElement('div');
                paletteItem.className = 'palette-item';
                paletteItem.textContent = i + 1;
                paletteItem.dataset.index = i;
                paletteItem.addEventListener('click', () => loadQuestion(i));
                questionPalette.appendChild(paletteItem);
            });
            updatePalette();
        }

        function updatePalette() {
            const paletteItems = questionPalette.querySelectorAll('.palette-item');
            paletteItems.forEach((item, i) => {
                item.classList.remove('answered', 'bookmarked', 'current');
                if (userAnswers[i] !== null) {
                    item.classList.add('answered');
                }
                if (bookmarkedQuestions[i]) {
                    item.classList.add('bookmarked');
                }
                if (i === currentQuestionIndex) {
                    item.classList.add('current');
                }
            });
        }

        function updateCounts() {
            answeredCountSpan.textContent = userAnswers.filter(answer => answer !== null).length;
            bookmarkedCountSpan.textContent = bookmarkedQuestions.filter(b => b).length;
            currentQuestionSpan.textContent = currentQuestionIndex + 1;
        }

        // Navigation event listeners
        prevBtn.addEventListener('click', () => {
            if (currentQuestionIndex > 0) {
                loadQuestion(currentQuestionIndex - 1);
            }
        });

        nextBtn.addEventListener('click', () => {
            if (currentQuestionIndex < questionsData.length - 1) {
                loadQuestion(currentQuestionIndex + 1);
            }
        });

        bookmarkBtn.addEventListener('click', () => {
            bookmarkedQuestions[currentQuestionIndex] = !bookmarkedQuestions[currentQuestionIndex];
            updatePalette();
            updateNavigationButtons(); // Update bookmark icon
            updateCounts();
        });

        submitBtn.addEventListener('click', () => {
            showReviewModal();
        });

        function showReviewModal() {
            reviewSummary.innerHTML = '';
            let answered = 0;
            let bookmarked = 0;
            let notAttempted = 0;

            // questionsData.forEach((q, i) => {
            //     const questionSummary = document.createElement('p');
            //     let statusText = '';
            //     if (userAnswers[i] !== null) {
            //         answered++;
            //         statusText = 'Answered';
            //     } else {
            //         notAttempted++;
            //         statusText = 'Not Attempted';
            //     }

            //     if (bookmarkedQuestions[i]) {
            //         bookmarked++;
            //         statusText += ' (Bookmarked)';
            //     }
            //     questionSummary.textContent = `Q${i + 1}: ${statusText}`;
            //     reviewSummary.appendChild(questionSummary);
            // });

            const summaryStats = document.createElement('div');
            summaryStats.innerHTML = `
                <p><strong>Total Questions:</strong> ${questionsData.length}</p>
                <p><strong>Answered:</strong> ${answered}</p>
                <p><strong>Not Attempted:</strong> ${notAttempted}</p>
                <p><strong>Bookmarked:</strong> ${bookmarked}</p>
            `;
            reviewSummary.prepend(summaryStats);
            
            reviewModal.classList.add('show');
        }

        continueTestBtn.addEventListener('click', () => {
            reviewModal.classList.remove('show');
        });

        finalSubmitBtn.addEventListener('click', () => {
            submitTest(false); // Submit with user's explicit action
        });

        async function submitTest(timeUp = false) {
            clearInterval(timerInterval);
            reviewModal.classList.remove('show');
            quizContainer.style.display = 'none';
            resultsContainer.style.display = 'block';

            correctAnswers = 0; // Reset for calculation
            questionsData.forEach((q, i) => {
                if (userAnswers[i] !== null && userAnswers[i] === q.correct) {
                    correctAnswers++;
                }
            });

            finalScore = correctAnswers;
            const totalTimeTaken = Math.floor((new Date() - quizStartTime) / 1000); // Time in seconds
            const minutesTaken = Math.floor(totalTimeTaken / 60);
            const secondsTaken = totalTimeTaken % 60;

            // Calculate Pass/Fail status
            userScorePercentage = (finalScore / totalQuestionsCount) * 100;
            userStatus = "Fail"; // Default to Fail
            if (userScorePercentage >= passingScorePercentage) {
                userStatus = "Pass";
            }

            // Display results
            scoreDisplay.textContent = `${userScorePercentage.toFixed(2)}%`; // Show percentage
            correctAnswersSpan.textContent = finalScore;
            wrongAnswersSpan.textContent = questionsData.length - finalScore;
            timeTakenSpan.textContent = `${minutesTaken.toString().padStart(2, '0')}:${secondsTaken.toString().padStart(2, '0')}`;
            totalScoreSpan.textContent = `${finalScore}/${questionsData.length}`;

            // Display Pass/Fail status clearly
            passStatus.textContent = `Status: ${userStatus}`;
            passStatus.style.color = userStatus === "Pass" ? "var(--success-color)" : "var(--danger-color)";
            passStatus.style.fontSize = "1.5rem";
            passStatus.style.fontWeight = "bold";


            // Store results in Firestore
            try {
                await db.collection('users').add({
                    name: userName,
                    email: userEmail,
                    score: finalScore,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    status: userStatus // Store the calculated status
                });
                // alert('Test submitted successfully!'); // You can remove this alert if you prefer
            } catch (error) {
                console.error("Error saving results:", error);
                showAlert('Submission Error', 'Failed to save test results. Please try again or contact support.');
            }
        }


        downloadCertificateBtn.addEventListener('click', () => {
            // This calls the generateCertificate function which is expected to be in certificate.js
            // Make sure generateCertificate is globally accessible (not inside an IIFE or strict module scope
            // unless handled with exports/imports).
            if (userStatus === "Fail") { //
                showAlert('Certificate Not Available', 'You need to pass the test to download the certificate.'); //
            } else if (typeof generateCertificate === 'function') { //
                generateCertificate(userName, userScorePercentage, finalScore, totalQuestionsCount, userStatus); //
            } else { //
                showAlert('Error', 'Certificate generation function (generateCertificate) not found in certificate.js. Please ensure it is correctly defined and globally accessible.'); //
            }
        });

        // Custom Alert Modal
        function showAlert(title, message) {
            alertTitle.textContent = title;
            alertMessage.textContent = message;
            alertModal.classList.add('show');
        }

        alertOkBtn.addEventListener('click', () => {
            alertModal.classList.remove('show');
        });

        // Prevent page refresh during test
        window.addEventListener('beforeunload', function(e) {
            if (quizContainer.style.display === 'block') {
                e.preventDefault();
                e.returnValue = '';
                return 'Are you sure you want to leave? Your progress will be lost.';
            }
        });

        // Disable right-click context menu during test
        document.addEventListener('contextmenu', function(e) {
            if (quizContainer.style.display === 'block') {
                e.preventDefault();
            }
        });

        // Disable certain keyboard shortcuts during test
        document.addEventListener('keydown', function(e) {
            if (quizContainer.style.display === 'block') {
                // Disable F12, Ctrl+Shift+I, Ctrl+U, etc.
                if (e.key === 'F12' || 
                    (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                    (e.ctrlKey && e.key === 'u')) {
                    e.preventDefault();
                }
            }
        });

        // Show notice modal on page load
        document.addEventListener('DOMContentLoaded', () => {
            noticeModal.classList.add('show');
        });

        // Close notice modal
        closeNoticeModalBtn.addEventListener('click', () => {
            noticeModal.classList.remove('show');
        });

    </script>
    <script src="certificate.js"></script>
</body>
</html>